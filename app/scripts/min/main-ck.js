var GP={common:{vars:{$body:$("body"),$html:$("html"),$overlay:$("#breaking_news-wrapper"),$lMain:$("#l_main"),$lNav:$("#l_navigation"),$darkenMain:$("#l_content--darken"),$darkenNav:$("#l_navigation-primary--darken"),$menu:$(".about_menu").find("a"),$section:$(".about-wrapper"),$horizontalSecondaryNav:$("#l_navigation-secondary-horizontal"),$verticalSecondaryNav:$("#l_navigation-secondary-vertical"),$headerButton:$(".header_button"),$headerInfoButton:$("#header_button-info"),$shareButton:$("#header_button-share"),$bannerArrow:$("#landing_page-banner"),$navHeaderExplore:$("#nav-header-explore"),$navHeaderMore:$("#nav-header-more"),$buttonNavigation:$("#header_button-navigation"),rightScroll:null,isTouch:null},init:function(){var e=GP.common.vars,a=$.fn.scrollTop,o=function(){var e=Array.prototype.slice.call(arguments),o=this.data("scroller");if(!o)return a.apply(this,e);if(!(e.length>0)){var t=o.y;return console.log(t),-t}o.scrollTo(0,e[0],0)};$.fn.scrollTop=o,e.$body.one("mouseover",function(){e.isTouch=e.isTouch||!1,e.isTouch||e.$body.trigger("gp:inputdetected:mouse")}).one("touchstart",function(){e.isTouch=e.isTouch||!0,e.isTouch&&e.$body.trigger("gp:inputdetected:touch")}),e.$darkenMain.on("click",this._mainClose),e.$darkenNav.on("click",this._navClose),e.$buttonNavigation.on("click",function(){GP.common.activate(this),e.$lMain.toggleClass("active-nav")}),e.$navHeaderMore.on("click",function(){GP.common.activate(this)}),e.$navHeaderExplore.on("click",function(){GP.common.activate(this),e.$lMain.toggleClass("active-nav-countries")}),e.$headerButton.on("click",this._headerActive),$("#content_filter-item-menu").on("click",function(){GP.common.activate(this),e.$lMain.toggleClass("active-nav"),$("#header_button-navigation").addClass("active")}),$(window).on("load",function(){e.rightScroll=GP.common.CreateScroll()}),$("#l_content-inner").scroll(this.isAtTop),e.$navHeaderMore.on("click",this._more);var t=$("h1, h2, h3, p, .content_item-headline");$(window).resize(function(){t.css("z-index",1)}),e.$shareButton.on("click",function(){GP.common.activate(this)}),$("#l_navigation-handle").length>0&&($("#l_navigation-handle").on("click",function(){e.$verticalSecondaryNav.hasClass("active")?e.$verticalSecondaryNav.removeClass("active"):e.$verticalSecondaryNav.addClass("active")}),$("#l_content").on("click",function(){e.$verticalSecondaryNav.hasClass("active")&&e.$verticalSecondaryNav.removeClass("active")})),e.$verticalSecondaryNav.find(".btn-nav_handle").on("click",function(){GP.articles._toggleQueueActive()})},isMobile:function(){var e=$(window).width();return 768>e},isAtTop:function(){var e=GP.common.vars,a=$(this).scrollTop();a>0?e.$body.addClass("scrolling"):e.$body.removeClass("scrolling")},showOverlay:function(){var e=this.vars;e.$body.toggleClass("overflow-hidden"),e.$html.toggleClass("overflow-hidden"),e.$overlay.hasClass("is-visible")?e.$overlay.removeClass("is-visible"):e.$overlay.addClass("is-visible")},_headerActive:function(){var e=GP.common.vars,a=$(this).is("#header_button-latest");a?GP.common.showOverlay():e.$overlay.removeClass("is-visible");var o=$(this).is("#nav-header-explore"),t=$("#l_main");o?t.hasClass("active-nav-countries")?t.removeClass("active-nav-countries"):t.addClass("active-nav-countries"):t.removeClass("active-nav-countries"),$(this).hasClass("active")?$(this).removeClass("active"):(e.$headerButton.removeClass("active"),$(this).addClass("active")),$(this).is("#header_button-info")||$("#info_list-wrapper").removeClass("active"),$(this).is("#header_button-share")||$("#fullscreen_social").removeClass("active")},activate:function(e){var a=$("#"+$(e).data("activate"));a.toggleClass("active")},bodyActivate:function(e){var a=$(e).data("activate");$("body").toggleClass(a+"-active")},_more:function(){var e=$(this).next(".nav-group-more-list");e.toggleClass("active")},_mainClose:function(){var e=GP.common.vars;e.$lMain.removeClass("active-nav"),e.$darkenMain.removeClass("active"),e.$body.removeClass("overflow-hidden"),e.$html.removeClass("overflow-hidden"),e.$buttonNavigation.removeClass("active")},_navClose:function(){var e=GP.common.vars;e.$lMain.removeClass("active-nav-countries"),e.$darkenNav.removeClass("active")},CreateScroll:function(){var e,a=GP.common.vars;if(a.$lcontent=$("#l_content"),!0&&$("#l_content").length>0){e=new IScroll("#l_content",{scrollbars:!0,mouseWheel:!0,interactiveScrollbars:!0,shrinkScrollbars:"clip",fadeScrollbars:!0,useTransform:!0,useTransition:!0,probeType:3,disableMouse:!0,disablePointer:!0,bounce:!1,deceleration:5e-4});var o=function(){a.$lcontent.data("scrollMonitor")&&scrollMonitor.update(a.$lcontent),a.$body.toggleClass("scrolling",0!==this.y&&this.directionY>=0)},t,n=function(){clearTimeout(t),t=setTimeout($.proxy(o,this),1e3/60)};e.on("scroll",n),e.on("scrollStart",o),e.on("scrollEnd",o),$("#l_content").data("scroller",e)}return a.$verticalSecondaryNav.length>0&&(a.leftScroll=new IScroll(a.$verticalSecondaryNav[0],{scrollbars:!0,mouseWheel:!0,interactiveScrollbars:!0,shrinkScrollbars:"scale",fadeScrollbars:!0,scrollX:!1,scrollY:!0,click:!0})),a.$horizontalSecondaryNav.length>0&&(a.topScroll=new IScroll("#l_navigation-secondary-horizontal",{eventPassthrough:!0,scrollbars:!0,mouseWheel:!0,interactiveScrollbars:!0,shrinkScrollbars:"scale",fadeScrollbars:!0,scrollX:!0,scrollY:!1})),e}},homepage:{init:function(){var e=GP.common.vars;$("#breaking_news-text-arrows .icon-circle-arrow-right").on("click",function(){$("#headline-1").css("display","none"),$("#headline-2").css("display","inline-block")}),$("#breaking_news-text-arrows .icon-circle-arrow-left").on("click",function(){$("#headline-1").css("display","inline-block"),$("#headline-2").css("display","none")}),$("#ca-container").contentcarousel(),$("#scroll-button").length>0&&$("#scroll-button").on("click touchstart",function(){var a=$("#breaking_news").position().top+"px";Modernizr.touch?setTimeout(function(){e.rightScroll.scrollToElement("#feature_article-body-id",1e3,null,null,IScroll.utils.ease.quadratic)},0):$("#l_content-inner").scrollTo(a,800)})}},landing:{init:function(){var e=GP.common.vars,a=e.$verticalSecondaryNav.children(),o=a.clone(!0);e.$horizontalSecondaryNav.append(o),e.$horizontalSecondaryNav.children().addClass("horizontal"),e.$bannerArrow.on("click",function(){GP.common.activate(this)})}},articles:{init:function(){function e(e){var a='<span class="fancybox-counter">'+(e.index+1)+" of "+e.group.length+"</span>";$(".fancybox-counter").length>0?($(".fancybox-counter").remove(),$("body").append(a)):$("body").append(a)}function a(e){var a=$("#links");if(!a.length){a=$('<ul id="links">');for(var o=0;o<e.group.length;o++)$('<li data-index="'+o+'"><label></label></li>').click(function(){$.fancybox.jumpto($(this).data("index"))}).appendTo(a);a.appendTo("body")}a.find("li").removeClass("active").eq(e.index).addClass("active")}function o(){$("#links").remove(),$(".fancybox-counter").remove()}var t=GP.common.vars,n=t.$verticalSecondaryNav.children(),i=n.clone(!0);t.$horizontalSecondaryNav.append(i),t.$horizontalSecondaryNav.children().addClass("horizontal"),$(".article_stream-item").on("click",this._menuClick),$(window).on("load",function(){$(".article-wrapper").each(GP.articles._Monitor),GP.common.vars.leftScroll.on("flick",function(){GP.articles._toggleQueueActive(this.distX>0)})}),$("#fancybox-manual-c").on("click",function(){$.fancybox.open([{href:"https://farm4.staticflickr.com/3685/13539935244_6189577f80_h.jpg",title:"Vroin rhoncus sem lobortis, iaculis tellus sit amet, gravida nibh. Vestibulum placerat quis turpis nec molestie. Etiam ac leo non magna bibendum tincidunt. Morbi rhoncus et diam nec commodo. Quisque nulla erat, pretium ac elit vel, faucibus vulputate erat."},{href:"http://farm4.staticflickr.com/3742/12148226023_6013bf72be_h.jpg",title:"Vroin rhoncus sem lobortis, iaculis tellus sit amet, gravida nibh. Vestibulum placerat quis turpis nec molestie. Etiam ac leo non magna bibendum tincidunt. Morbi rhoncus et diam nec commodo. Quisque nulla erat, pretium ac elit vel, faucibus vulputate erat."},{href:"https://farm4.staticflickr.com/3701/13541521543_9712f82f2c_b.jpg",title:"Vroin rhoncus sem lobortis, iaculis tellus sit amet, gravida nibh. Vestibulum placerat quis turpis nec molestie. Etiam ac leo non magna bibendum tincidunt. Morbi rhoncus et diam nec commodo. Quisque nulla erat, pretium ac elit vel, faucibus vulputate erat."}],{local:this,padding:[50,0,20,0],margin:[15,15,40,15],nextEffect:"fade",prevEffect:"fade",helpers:{title:{type:"inside",position:"bottom"},buttons:{position:"bottom"}},afterLoad:function(a){e(a)},beforeClose:o})})},_toggleQueueActive:function(e){var a=GP.common.vars;a.$verticalSecondaryNav.toggleClass("active",e)},_menuClick:function(){var e="#"+$(this).attr("href"),a=$(e).position().top,o=GP.common.vars;o.rightScroll.scrollTo(0,-a,1e3,IScroll.utils.ease.quadratic),setTimeout(function(){o.$verticalSecondaryNav.removeClass("active")},1500)},_Monitor:function(e,a){if(!0){var o=this,t=GP.common.vars,n=scrollMonitor.create(a,0===e?{top:500}:{top:10},$("#l_content")),i=$(".header-article_headline"),l=$(a).find(".article").attr("id"),c=$(".article_stream-item"),r=function(){var e=$(a).find(".article_headline").text();i.text(e),c.each(function(e,a){var o=$(this),t=o.attr("href");t&&t===l?o.addClass("active"):o.removeClass("active")})},s,v=function(){clearTimeout(s),s=setTimeout($.proxy(r,o),100)};n.fullyEnterViewport(v)}}},feature:{init:function(){var e=GP.common.vars;$("#feature_navigation").on("click",function(){GP.common.activate(this),e.$lMain.toggleClass("active-nav")}),$("#feature-chapters").on("click",function(){GP.common.bodyActivate(this)}),$("#scroll-button").length>0&&$("#scroll-button").on("click touchstart",function(){var a=$("#feature_article-body-id").position().top+"px";Modernizr.touch?setTimeout(function(){e.rightScroll.scrollToElement("#feature_article-body-id",1e3,null,null,IScroll.utils.ease.quadratic)},0):$("#l_content-inner").scrollTo(a,800)})}},slideshow:{init:function(){}},about:{init:function(){var e=GP.common.vars,a={teamsTemplate:Handlebars.compile($("#teamsTemplate").html())};for(i=0,m=teams.length;m>i;i++){var o=$("#team .about-body");o.append(a.teamsTemplate(teams[i]))}e.$menu.on("click",this._aboutSelectSection),$(window).on("load",function(){""!==location.hash&&GP.about._aboutSelectSection()})},_aboutSelectSection:function(e){var a=GP.common.vars,o=$(e?this:".about_menu [href = "+location.hash+"]"),t=o.attr("href");t.match(/^#/)&&($("#l_content-inner").scrollTo(0,400),a.$menu.removeClass("active"),o.addClass("active"),a.$section.filter(".active").fadeOut(200,function(){$(this).removeClass("active"),$(t).fadeIn(200).addClass("active")}),setTimeout(function(){a.$verticalSecondaryNav.removeClass("active")},1e3))}}};UTIL={fire:function(e,a,o){var t=GP;a=void 0===a?"init":a,""!==e&&t[e]&&"function"==typeof t[e][a]&&t[e][a](o)},loadEvents:function(){var e=document.body.id;UTIL.fire("common"),$.each(document.body.className.split(/\s+/),function(a,o){UTIL.fire(o),UTIL.fire(o,e)}),UTIL.fire("common","finalize")}},$(UTIL.loadEvents);